## Chapter 17 - Anti-Virtual Machines Techniques

Chapter 17 revolves around virtual machine detection- in a sense of detecting whether the author's program is executing inside of a virtual machine. This is useful for malware developers, as it's very likely that the reverser will run and analyze the sample inside of a VM. The book focuses on techniques regarding VMware virtual machines.
Although the methods in the book are somewhat outdated- for example, the book talks about assembly instruction that rely on the machine to have a single-core processor which is not present nowadays on modern machines, it's relatively easy to find indicators of VM-presence. VMware leaves dozens of artifacts, as VMware is not trying to hide them- but rather embraces them and encourages the user to use them as they provide the end user with multiple capabilities like VM Tools.

The techniques that are relevant to Windows usually also work on Linux (with obvious exceptions like Registry querying), but we will need to adjust the techniques to the linux platform. For example, the VMware processes on Linux may have different names compared to their Windows counterparts, and the directories used by VMware on Linux will naturally occur in a different naming scheme compared to Windows.

Your objective in this lab is to patch and bypass all 6 anti-VMware techniques, in order to be run the malware as it should when there is no virtual machine. The malware itself is a bind shell implementation, with a few custom functions as well. The pma_17_client.py Python script is there to help you connect to the "victim's" machine. The end goal is to be able to connect to the victim's port running the malware and execute all the custom & normal bash commands without interference from the anti-VMare mechanisms. The techniques themselves will be of slightly varying difficulty in terms of recognizing and patching, but in reality most anti-VM techniques at their base are rather straightforward and easy to patch (assuming there is no code obfuscation, encryptions, etc.).